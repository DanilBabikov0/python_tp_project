# Генератор Палитр API

## Базовый URL

```
http://localhost:8000/api/
```

## Аутентификация

Большинство GET-запросов не требуют аутентификации. Для операций, связанных с сохранением и удалением данных, требуется:

1. **Авторизация пользователя** (сессии Django)
2. **CSRF токен** для POST/DELETE запросов

CSRF токен автоматически устанавливается при посещении сайта и хранится в cookies.

---

## Эндпоинты

### Генерация палитр

#### 1. **Генерация палитры по цвету**
```
GET /api/palettes/generate/
```

**Параметры:**
- `base` (обязательный) - HEX цвет без `#` (например: `FF5733`)

**Успешный ответ (200 OK):**
```json
{
  "base_color": "#ff5733",
  "analogous": [
    "#ff5733",
    "#ffbc32",
    "#ff3274"
  ],
  "complementary": [
    "#ff5733",
    "#32daff"
  ],
  "triadic": [
    "#ff5733",
    "#32ff56",
    "#5632ff"
  ],
  "monochromatic": [
    "#cb2400",
    "#ff2d00",
    "#ff5732",
    "#ff8165",
    "#ffab99"
  ]
}      
```

**Ошибки:**
- `400 Bad Request` - если параметр `base` отсутствует или неверный формат цвета

#### 2. **Случайные палитры**
```
GET /api/palettes/random/
```

**Параметры:** нет

**Успешный ответ (200 OK):**
```json
{
  "base_color": "#1d5dd1",
  "analogous": [
    "#1d5dd1",
    "#361dd1",
    "#1db6d1"
  ],
  "complementary": [
    "#1d5dd1",
    "#d1911d"
  ],
  "triadic": [
    "#1d5dd1",
    "#d11d5d",
    "#5dd11d"
  ],
  "monochromatic": [
    "#103577",
    "#1649a4",
    "#1d5cd1",
    "#3c78e4",
    "#6997ea"
  ]
}
```

---

### Работа с цветами

#### 3. **Получение названия цвета**
```
GET /api/color/name/
```

**Параметры:**
- `color` (обязательный) - HEX цвет (можно с `#` или без)

**Успешный ответ (200 OK):**
```json
"Outrageous Orange"
```

**Ошибки:**
- `400 Bad Request` - если параметр `color` отсутствует

---

### Пользовательские палитры

#### 4. **Получение всех палитр пользователя**
```
GET /api/palettes/{username}/
```

**Параметры пути:**
- `username` (обязательный) - Имя пользователя

**Успешный ответ (200 OK):**
```json
[
  {
    "id": 112,
    "name": "monochromatic",
    "colors": [
      "#acc864",
      "#c0d58a",
      "#d5e3b0",
      "#e9f0d5",
      "#fdfdfb"
    ]
  },
  {
    "id": 113,
    "name": "complementary",
    "colors": [
      "#00efb5",
      "#ef0039"
    ]
  },
  {
    "id": 114,
    "name": "triadic",
    "colors": [
      "#aa40a3",
      "#a3aa40",
      "#40a3aa"
    ]
  },
]
```

**Ошибки:**
- `404 Not Found` - если пользователь не найден

#### 5. **Получение конкретной палитры**
```
GET /api/palettes/{username}/{palette_id}/
```

**Параметры пути:**
- `username` (обязательный) - Имя пользователя
- `palette_id` (обязательный) - ID палитры

**Успешный ответ (200 OK):**
```json
{
  "id": 112,
  "name": "monochromatic",
  "colors": [
    "#acc864",
    "#c0d58a",
    "#d5e3b0",
    "#e9f0d5",
    "#fdfdfb"
  ]
}
```

**Ошибки:**
- `404 Not Found` - если пользователь или палитра не найдены

#### 6. **Сохранение палитры**
```
POST /api/palettes/{username}/save/
```

**Требуется:** Авторизация, CSRF токен

**Параметры пути:**
- `username` (обязательный) - Имя пользователя

**Тело запроса (JSON):**
```json
{
    "name": "Название палитры",
    "colors": ["#FF5733", "#33FF57", "#3357FF"]
}
```

**Успешный ответ (200 OK):**
```json
{
    "id": 3,
    "name": "Название палитры",
    "colors": ["#FF5733", "#33FF57", "#3357FF"]
}
```

**Ошибки:**
- `400 Bad Request` - если отсутствуют обязательные поля или неверный формат
- `403 Forbidden` - если пользователь не авторизован или пытается сохранить от чужого имени
- `404 Not Found` - если пользователь не найден

#### 7. **Удаление палитры**
```
DELETE /api/palettes/{username}/{palette_id}/delete/
```

**Требуется:** Авторизация, CSRF токен

**Параметры пути:**
- `username` (обязательный) - Имя пользователя
- `palette_id` (обязательный) - ID палитры

**Успешный ответ (200 OK):**
```json
{
    "success": true
}
```

**Ошибки:**
- `403 Forbidden` - если пользователь не авторизован или пытается удалить чужую палитру
- `404 Not Found` - если палитра не найдена

---

### Извлечение цветов из изображений

#### 8. **Извлечение цветов из изображения**
```
POST /api/image/extract/
```

**Требуется:** Авторизация, CSRF токен

**Параметры формы (multipart/form-data):**
- `image` (обязательный) - Файл изображения (JPG, PNG, GIF, WEBP, ≤10MB)
- `count` (необязательный) - Количество цветов (1-10, по умолчанию 5)

**Успешный ответ (200 OK):**
```json
{
    "colors": ["#FF5733", "#33FF57", "#3357FF", "#F1C40F", "#9B59B6"],
    "count": 5,
    "filename": "landscape.jpg",
    "palette_id": 10,
    "created_at": "2024-01-15T10:30:00Z"
}
```

**Ошибки:**
- `400 Bad Request` - если изображение не предоставлено
- `403 Forbidden` - если пользователь не авторизован
- `429 Too Many Requests` - если превышен лимит запросов (10 в час)
- `500 Internal Server Error` - если произошла ошибка при обработке изображения

#### 9. **Получение всех палитр из изображений пользователя**
```
GET /api/image/{username}/
```

**Параметры пути:**
- `username` (обязательный) - Имя пользователя

**Успешный ответ (200 OK):**
```json
[
    {
        "id": 10,
        "image_name": "landscape.jpg",
        "preview": "/media/previews/landscape_thumb.jpg",
        "colors": ["#FF5733", "#33FF57", "#3357FF"],
        "created_at": "2024-01-15T10:30:00Z"
    },
    {
        "id": 11,
        "image_name": "portrait.png",
        "preview": null,
        "colors": ["#E74C3C", "#3498DB", "#2ECC71"],
        "created_at": "2024-01-15T11:00:00Z"
    }
]
```

**Ошибки:**
- `404 Not Found` - если пользователь не найден

#### 10. **Получение конкретной палитры изображения**
```
GET /api/image/{username}/{id}/
```

**Параметры пути:**
- `username` (обязательный) - Имя пользователя
- `id` (обязательный) - ID палитры изображения

**Успешный ответ (200 OK):**
```json
{
    "id": 10,
    "image_name": "landscape.jpg",
    "preview": "/media/previews/landscape_thumb.jpg",
    "colors": ["#FF5733", "#33FF57", "#3357FF"],
    "created_at": "2024-01-15T10:30:00Z"
}
```

**Ошибки:**
- `404 Not Found` - если палитра или пользователь не найдены

#### 11. **Удаление палитры изображения**
```
DELETE /api/image/{username}/{id}/delete/
```

**Требуется:** Авторизация, CSRF токен

**Параметры пути:**
- `username` (обязательный) - Имя пользователя
- `id` (обязательный) - ID палитры изображения

**Успешный ответ (200 OK):**
```json
{
    "success": true
}
```

**Ошибки:**
- `403 Forbidden` - если пользователь не авторизован или пытается удалить чужую палитру
- `404 Not Found` - если палитра не найдена

## ⚠️ Коды ошибок

| Код | Описание | Возможные причины |
|-----|----------|-------------------|
| 400 | Неверный запрос | Отсутствуют обязательные параметры, неверный формат цвета или данных |
| 403 | Доступ запрещен | Попытка доступа к чужим данным, неверный CSRF токен, неавторизованный доступ |
| 404 | Не найдено | Пользователь, палитра или изображение не существуют |
| 429 | Слишком много запросов | Превышен лимит извлечения цветов (10 запросов в час на пользователя) |
| 500 | Внутренняя ошибка сервера | Проблемы с обработкой изображения или другие серверные ошибки |